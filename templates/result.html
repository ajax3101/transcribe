{% extends "base.html" %}

{% block title %}Result - Karaoke App{% endblock %}

{% block content %}
<h1 class="text-center">Karaoke Result</h1>

<div class="mt-4 text-center">
    <audio id="audio" controls>
        <source src="{{ url_for('uploaded_file', filename=filename) }}" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>
</div>

<div id="lyrics" class="mt-5 text-center">
    {% for word in words %}
        <span data-start="{{ word.start }}" data-end="{{ word.end }}">{{ word.word }}</span>
    {% endfor %}
</div>

<script>
const audio = document.getElementById('audio');
const words = document.querySelectorAll('#lyrics span');

audio.ontimeupdate = function() {
    const currentTime = audio.currentTime;
    words.forEach(word => {
        const start = parseFloat(word.dataset.start);
        const end = parseFloat(word.dataset.end);

        if (currentTime >= start && currentTime <= end) {
            word.classList.add('highlight');
        } else {
            word.classList.remove('highlight');
        }
    });
};
</script>

<style>
#lyrics span {
    font-size: 24px;
    margin: 0 5px;
    transition: color 0.3s;
}
#lyrics span.highlight {
    color: red;
    font-weight: bold;
}
</style>
{% endblock %}
